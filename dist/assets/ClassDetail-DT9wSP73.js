import{u as _,j as e,c as v}from"./index-CKUJbCT9.js";import{e as z,u as G,r as l}from"./react-vendor-aXCYw_-y.js";import{a as M,b as q}from"./classService-C6ODzT_y.js";import{c as O}from"./api-C9ytrIjn.js";import{A as b,D as w,R as V,E as W,n as y,U as C,t as R,s as Y,q as H,z as S,k as J,u as K}from"./ui-vendor-DRNSJ1fN.js";const u={X:{bg:"bg-blue-50",text:"text-blue-700",gradient:"from-blue-500 to-cyan-400",border:"border-blue-200",icon:K},XI:{bg:"bg-purple-50",text:"text-purple-700",gradient:"from-purple-500 to-pink-400",border:"border-purple-200",icon:S},XII:{bg:"bg-green-50",text:"text-green-700",gradient:"from-green-500 to-emerald-400",border:"border-green-200",icon:J},default:{bg:"bg-indigo-50",text:"text-indigo-700",gradient:"from-indigo-500 to-blue-400",border:"border-indigo-200",icon:S}},k={good:{color:"text-green-700",bgColor:"bg-green-50",borderColor:"border-green-200",icon:R},warning:{color:"text-yellow-700",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",icon:Y},critical:{color:"text-red-700",bgColor:"bg-red-50",borderColor:"border-red-200",icon:b}};function ae(){const{id:i}=z(),m=G(),{t:r}=_(),[t,L]=l.useState(null),[n,$]=l.useState([]),[E,f]=l.useState(!0),[p,x]=l.useState(null),[g,A]=l.useState(""),[c,D]=l.useState("all"),[T,P]=l.useState(0),U=3,h=l.useCallback(async()=>{if(i)try{f(!0),x(null);const{clearTimeout:s}=O(15e3),a=await M(i);L(a);const o=await q(i);o&&o.students&&$(o.students),s()}catch(s){console.error("Error loading class data:",s),x(s instanceof Error?s.message:r("errors.loadingClass")||"Gagal memuat data kelas")}finally{f(!1)}},[i,r]);l.useEffect(()=>{h()},[h]);const I=()=>{T<U?(P(s=>s+1),h()):x(r("errors.maxRetriesReached")||"Batas percobaan telah tercapai")},j=s=>{m(`/students/${s.id}`)},N=n.filter(s=>{const a=s.name.toLowerCase().includes(g.toLowerCase()),o=c==="all"||s.academicStatus===c;return a&&o}),X=()=>{var a;if(!t)return u.default;const s=((a=t.gradeLevel.split(" ")[0])==null?void 0:a.trim().toUpperCase())||"";return u[s]||u.default},B=()=>`/api/classes/${i}/report`;if(E)return e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-7 bg-gray-200 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"})]})]}),e.jsx("div",{className:"h-40 bg-gray-200 rounded-xl"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[...Array(3)].map((s,a)=>e.jsx("div",{className:"h-20 bg-gray-200 rounded-xl"},a))}),e.jsx("div",{className:"h-12 bg-gray-200 rounded-xl"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((s,a)=>e.jsx("div",{className:"h-24 bg-gray-200 rounded-xl"},a))})]});if(p||!t)return e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md border border-red-100",children:[e.jsx(b,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600 font-medium mb-4",children:p||r("errors.classNotFound")}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs("button",{onClick:()=>m("/classes"),className:"px-4 py-2 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors",children:[e.jsx(w,{className:"h-4 w-4 inline mr-2"}),r("actions.backToClasses")]}),e.jsxs("button",{onClick:I,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[e.jsx(V,{className:"h-4 w-4 inline mr-2"}),r("actions.retry")]})]})]});const d=X();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>m("/classes"),className:"inline-flex items-center text-indigo-600 hover:text-indigo-800 transition-colors mb-4",children:[e.jsx(w,{className:"h-5 w-5 mr-1"}),r("classes.backToClasses")]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 w-full h-2 bg-gradient-to-r ${d.gradient}`}),e.jsxs("div",{className:"flex items-start md:items-center flex-col md:flex-row md:justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-lg bg-gradient-to-br ${d.gradient} shadow-sm`,children:e.jsx(d.icon,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d.bg} ${d.text} border ${d.border}`,children:t.gradeLevel}),e.jsx("span",{className:"mx-2 text-gray-300",children:"â€¢"}),e.jsx("span",{className:"text-sm text-gray-600",children:t.academicYear})]})]})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs("a",{href:B(),download:`${t.name}-report.pdf`,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 shadow-sm transition-all duration-200 transform hover:scale-105",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),r("classes.downloadReport")]})})]}),t.teacherName&&e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx(y,{className:"h-5 w-5 text-indigo-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-xs text-gray-500",children:r("classes.teacher")}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.teacherName})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-200 transform transition-all duration-300 hover:shadow-md hover:border-indigo-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg mr-4",children:e.jsx(C,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:r("classes.studentCount")}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:n.length})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-200 transform transition-all duration-300 hover:shadow-md hover:border-green-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-50 rounded-lg mr-4",children:e.jsx(R,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:r("classes.goodStatus")}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-green-600",children:n.filter(s=>s.academicStatus==="good").length})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-200 transform transition-all duration-300 hover:shadow-md hover:border-red-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-red-50 rounded-lg mr-4",children:e.jsx(b,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:r("classes.needsAttention")}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-red-600",children:n.filter(s=>s.academicStatus==="warning"||s.academicStatus==="critical").length})]})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:r("classes.students")}),e.jsx("div",{className:"flex space-x-2",children:["all","good","warning","critical"].map(s=>e.jsx("button",{onClick:()=>D(s),className:v("px-3 py-1.5 rounded-md text-xs font-medium transition-all duration-200",c===s?s==="all"?"bg-indigo-600 text-white":s==="good"?"bg-green-600 text-white":s==="warning"?"bg-yellow-600 text-white":"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:r(s==="all"?"status.all":`status.${s}`)},s))})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("input",{type:"text",placeholder:r("students.search"),value:g,onChange:s=>A(s.target.value),className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),N.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[e.jsx(C,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:r(g||c!=="all"?"students.noResults":"students.noStudents")})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(s=>{const a=s.academicStatus||"warning",o=k[a]||k.warning;return e.jsxs("div",{onClick:()=>j(s),className:"border border-gray-200 rounded-lg p-4 hover:border-indigo-300 hover:shadow-md transition-all cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:s.avatar?e.jsx("img",{src:s.avatar,alt:s.name,className:"h-full w-full object-cover"}):e.jsx(y,{className:"h-5 w-5 text-gray-500"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.email})]})]}),e.jsx("div",{className:v("px-2.5 py-0.5 rounded-full text-xs font-medium",o.bgColor,o.color),children:r(`status.${a}`)})]}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsxs("button",{className:"text-xs text-indigo-600 flex items-center opacity-0 hover:opacity-100 group-hover:opacity-100 transition-opacity",onClick:F=>{F.stopPropagation(),j(s)},children:[r("actions.viewProfile","View Profile"),e.jsx(H,{className:"ml-1 h-3 w-3"})]})})]},s.id)})})]})})]})}export{ae as default};
