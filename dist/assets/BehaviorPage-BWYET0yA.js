import{m as B,u as Pe,o as Ie,b as _e,a as Me,j as e,c as n,_ as ne}from"./index-Cpum2A6d.js";import{r as l}from"./react-vendor-BzbKlFBU.js";import{t as p}from"./toast-M3i0mrg7.js";import{y as le,A as N,Y as $e,z as me,r as J,Q as Be,_ as de,U as Oe,E as xe,s as P,v as ze,a1 as Fe,J as Ve,T as Le,X as I,D as Ue}from"./ui-vendor-CCWSLpt1.js";const X=[],qe=d=>{const t=new Set,a=[];for(const o of d)if(!t.has(o.id))t.add(o.id),a.push(o);else{const g=`${o.id}-${Date.now()}`;t.add(g),a.push({...o,id:g})}return a},he=!0;let O=!1;const $=async(d,t,a=1)=>{try{if(he||!O){const g=await B.get("/behavior-records",{params:{student:d,page:a,...t}}),k=qe(g.data.results||[]);return{data:k,count:g.data.count||k.length,totalPages:g.data.total_pages||1,currentPage:g.data.current_page||a}}let o=X.filter(g=>g.studentId===d);return{data:o,count:o.length,totalPages:1,currentPage:1}}catch(o){throw console.error("Error loading behavior records:",o),o}},ge=async d=>{try{if(he||!O)return console.log("Creating behavior record with data:",d),(await B.post("/behavior-records",d)).data;const t={...d,id:String(X.length+1)};return X.push(t),t}catch(t){throw console.error("Error creating behavior record:",t),t}},We=async(d,t)=>{try{return(await B.put(`/behavior-records/${d}`,t)).data}catch(a){throw console.error("Error updating behavior record:",a),a}},Ge=async d=>{try{await B.delete(`/behavior-records/${d}`)}catch(t){throw console.error("Error deleting behavior record:",t),t}},ce=Object.freeze(Object.defineProperty({__proto__:null,createBehaviorRecord:ge,deleteBehaviorRecord:Ge,getBehaviorRecords:$,updateBehaviorRecord:We},Symbol.toStringTag,{value:"Module"})),_={positive:{bgColor:"bg-green-50",textColor:"text-green-700",borderColor:"border-green-200",gradient:"from-green-500 to-teal-400",icon:me},neutral:{bgColor:"bg-gray-50",textColor:"text-gray-700",borderColor:"border-gray-200",gradient:"from-gray-400 to-gray-300",icon:xe},minor:{bgColor:"bg-yellow-50",textColor:"text-yellow-700",borderColor:"border-yellow-200",gradient:"from-yellow-500 to-amber-400",icon:J},major:{bgColor:"bg-red-50",textColor:"text-red-700",borderColor:"border-red-200",gradient:"from-red-500 to-rose-400",icon:N}},M={attendance:{icon:J,bgColor:"bg-blue-50",textColor:"text-blue-700",borderColor:"border-blue-200"},discipline:{icon:N,bgColor:"bg-purple-50",textColor:"text-purple-700",borderColor:"border-purple-200"},participation:{icon:xe,bgColor:"bg-green-50",textColor:"text-green-700",borderColor:"border-green-200"},social:{icon:Oe,bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"}};function Ye({studentId:d}){var re,ae,oe;const{t}=Pe(),{user:a,isStudent:o}=Ie(),[g,k]=l.useState(""),[w,z]=l.useState([]),[ue,K]=l.useState(!0),[Q,v]=l.useState(null),[F,C]=l.useState(!1),[f,S]=l.useState(!1),[V,pe]=l.useState("all"),[be,R]=l.useState(!1),[ve,D]=l.useState(!1),[fe,L]=l.useState(!1),[c,U]=l.useState(null),[m,y]=l.useState(null),[q,Y]=l.useState(!1),Z=d||(o?a==null?void 0:a.id:""),[T,W]=l.useState(Z||""),[E,ye]=l.useState([]),[je,ee]=l.useState(!1),[Ne,we]=l.useState(0),Ce=3,[i,u]=l.useState({studentId:Z||"",category:"discipline",severity:"neutral",description:"",actionTaken:""}),se=l.useCallback(async()=>{if(!(d||o))try{ee(!0);const s=await _e({},1);s&&s.data&&ye(s.data)}catch(s){console.error("Error loading students:",s)}finally{ee(!1)}},[d,o]),j=l.useCallback(async()=>{try{K(!0),v(null);const{clearTimeout:s}=Me(15e3);let r;T?r=await $(T):o&&(a!=null&&a.id)?r=await $(a.id):r=await $("",{},1),s(),r&&r.data?z(r.data):(v(t("errors.invalidData")||"Format respons tidak valid"),z([]))}catch(s){console.error("Error loading behavior records:",s),s instanceof Error?s.name==="AbortError"||s.message.includes("timeout")?v(t("errors.timeout")||"Waktu permintaan habis"):v(s.message||t("errors.loadingRecords")||"Gagal memuat data"):v(t("errors.loadingRecords")||"Gagal memuat data"),z([])}finally{K(!1)}},[T,o,a==null?void 0:a.id,t]),ke=async s=>{if(s.preventDefault(),!i.studentId){p.error(t("behavior.noStudentSelected")||"Silakan pilih siswa terlebih dahulu");return}if(!i.description.trim()){p.error(t("behavior.descriptionRequired")||"Deskripsi tidak boleh kosong");return}try{S(!0);const r={studentId:i.studentId,date:new Date().toISOString().split("T")[0],type:i.severity==="positive"?"positive":"negative",description:i.description,category:i.category,severity:i.severity,reporter:{id:(a==null?void 0:a.userId)||"system",name:(a==null?void 0:a.name)||"System"},...i.actionTaken?{actionTaken:i.actionTaken}:{}};if(await ge(r))p.success(t("behavior.recordCreated")||"Catatan berhasil dibuat"),C(!1),i.studentId!==T?W(i.studentId):j(),u({studentId:i.studentId,category:"discipline",severity:"neutral",description:"",actionTaken:""});else throw new Error("Failed to create record")}catch(r){console.error("Error creating behavior record:",r),p.error(r instanceof Error?r.message:t("behavior.createFailed")||"Gagal membuat catatan")}finally{S(!1)}},Se=s=>{const r=s.target.value;u({...i,studentId:r})},te=s=>{U(s),L(!0)},Re=s=>{y({...s}),R(!0)},De=s=>{U(s),D(!0)},Te=async s=>{if(s.preventDefault(),!!m)try{S(!0);const{updateBehaviorRecord:r}=await ne(async()=>{const{updateBehaviorRecord:h}=await Promise.resolve().then(()=>ce);return{updateBehaviorRecord:h}},void 0);await r(m.id,{category:m.category,severity:m.severity,description:m.description,actionTaken:m.actionTaken}),p.success(t("behavior.recordUpdated")||"Record updated successfully"),R(!1),y(null),j()}catch(r){console.error("Error updating behavior record:",r),p.error(r instanceof Error?r.message:t("behavior.updateFailed")||"Failed to update record")}finally{S(!1)}},Ee=async()=>{if(c)try{Y(!0);const{deleteBehaviorRecord:s}=await ne(async()=>{const{deleteBehaviorRecord:r}=await Promise.resolve().then(()=>ce);return{deleteBehaviorRecord:r}},void 0);await s(c.id),p.success(t("behavior.recordDeleted")||"Record deleted successfully"),D(!1),U(null),j()}catch(s){console.error("Error deleting behavior record:",s),p.error(s instanceof Error?s.message:t("behavior.deleteFailed")||"Failed to delete record")}finally{Y(!1)}},Ae=()=>{Ne<Ce?(we(s=>s+1),j()):v(t("errors.maxRetriesReached")||"Batas percobaan telah tercapai")};l.useEffect(()=>{j()},[j]),l.useEffect(()=>{if(d)W(d),u(s=>({...s,studentId:d}));else if(o&&(a!=null&&a.id)){const s=a.id;W(s),u(r=>({...r,studentId:s}))}},[d,o,a==null?void 0:a.id]),l.useEffect(()=>{F&&se()},[F,se]);const G=w.filter(s=>{const r=s.description.toLowerCase().includes(g.toLowerCase()),h=V==="all"||s.category===V;return r&&h}),A=(()=>{const s=w.filter(x=>new Date(x.date).getMonth()===new Date().getMonth()),r=w.filter(x=>x.severity==="positive"),h=w.filter(x=>x.severity==="major");return{thisMonth:s.length,positive:r.length,needsAttention:h.length,total:w.length}})();return ue?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-700 w-12 h-12 rounded-lg flex items-center justify-center shadow-lg mr-4 animate-pulse",children:e.jsx(le,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 w-48 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 w-64 bg-gray-200 rounded"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((s,r)=>e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm animate-pulse border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-200 mr-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded"})]})]})},r))}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsx("div",{className:"animate-pulse space-y-6",children:[...Array(3)].map((s,r)=>e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-gray-200 rounded-full"})]}),e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded"})]},r))})})]}):Q?e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-xl border border-red-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-2",children:e.jsx(N,{className:"h-6 w-6 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-red-700",children:t("behavior.errorLoading")||"Gagal memuat catatan perilaku"})]}),e.jsx("p",{className:"text-red-600 mb-6 pl-11",children:Q}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:Ae,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors shadow-sm",children:[e.jsx($e,{className:"h-4 w-4 mr-2 animate-spin-slow"}),t("actions.retry")||"Coba Lagi"]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-700 w-12 h-12 rounded-lg flex items-center justify-center shadow-lg mr-4",children:e.jsx(le,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600",children:o?t("behavior.studentTitle")||"My Behavior Records":t("behavior.title")||"Behavior Records"}),e.jsx("p",{className:"text-gray-500 mt-1",children:o?t("behavior.studentSubtitle")||"View your behavior history and patterns":t("behavior.subtitle")||"Track and manage student behavior patterns"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-indigo-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg mr-4",children:e.jsx(N,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.total")||"Total Records"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:A.total})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-green-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-50 rounded-lg mr-4",children:e.jsx(me,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.positive")||"Positive"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-green-600",children:A.positive})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-blue-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg mr-4",children:e.jsx(J,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.thisMonth")||"This Month"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-blue-600",children:A.thisMonth})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-red-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-red-50 rounded-lg mr-4",children:e.jsx(N,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.needsAttention")||"Needs Attention"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-red-600",children:A.needsAttention})]})]})})]}),e.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Be,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:t("behavior.search")||"Search records...",value:g,onChange:s=>k(s.target.value),className:"pl-10 pr-4 py-2.5 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"bg-gray-100 p-1 rounded-lg flex",children:["all","attendance","discipline","participation","social"].map(s=>e.jsx("button",{onClick:()=>pe(s),className:n("px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200",V===s?"bg-indigo-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-200"),children:s==="all"?t("behavior.all")||"All":t(`behavior.category.${s}`)||s},s))}),!o&&e.jsxs("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 shadow-sm transition-all duration-200 transform hover:scale-105",children:[e.jsx(de,{className:"h-5 w-5 mr-2"}),t("behavior.newRecord")||"New Record"]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:G.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"mx-auto h-20 w-20 text-gray-400 mb-4",children:e.jsx(N,{className:"h-full w-full"})}),e.jsx("p",{className:"text-gray-500 font-medium mb-4",children:t("behavior.noRecordsFound")||"No records found"}),!o&&e.jsxs("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 shadow-sm transition-colors",children:[e.jsx(de,{className:"h-5 w-5 mr-2"}),t("behavior.addFirstRecord")||"Add First Record"]})]}):o?e.jsx("div",{className:"divide-y divide-gray-200",children:G.map(s=>{var x;const r=M[s.category],h=_[s.severity];return e.jsx("div",{className:"group hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:n("p-2 rounded-lg",r.bgColor),children:e.jsx(r.icon,{className:n("h-5 w-5",r.textColor)})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:P(new Date(s.date),"PPP")}),e.jsx("span",{className:n("ml-2 text-xs px-2 py-0.5 rounded-full font-medium",r.bgColor,r.textColor),children:t(`behavior.category.${s.category}`)||s.category})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:s.description})]})]}),e.jsxs("div",{className:n("px-3 py-1.5 rounded-lg text-xs font-medium flex items-center",h.bgColor,h.textColor,`border ${h.borderColor}`),children:[e.jsx(h.icon,{className:"h-4 w-4 mr-1.5"}),t(`behavior.severity.${s.severity}`)||s.severity]})]}),s.actionTaken&&e.jsx("div",{className:"mt-4 pl-11",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action:",":"]})," ",s.actionTaken]})}),e.jsxs("div",{className:"mt-4 pl-11 flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[t("behavior.reportedBy")||"Reported by",": ",((x=s.reporter)==null?void 0:x.name)||"System"]}),e.jsxs("button",{onClick:H=>{H.stopPropagation(),te(s)},className:"opacity-0 group-hover:opacity-100 transition-opacity text-sm font-medium text-indigo-600 hover:text-indigo-700 flex items-center",children:[t("behavior.viewDetails")||"View Details",e.jsx(ze,{className:"h-4 w-4 ml-1.5"})]})]})]})},s.id)})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.date")||"Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.student")||"Student"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.category")||"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.severity")||"Severity"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.description")||"Description"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.actionTaken")||"Action Taken"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.reporter")||"Reported By"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.actions")||"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:G.map(s=>{var ie;const r=M[s.category],h=_[s.severity],x=E.find(b=>b.id===s.studentId),H=(x==null?void 0:x.name)||s.studentId;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:P(new Date(s.date),"dd/MM/yyyy")}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:H}),x&&e.jsxs("div",{className:"text-sm text-gray-500",children:[x.tingkat||x.grade," ",x.kelas||x.class]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:n("p-1.5 rounded-lg mr-2",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:n("text-xs px-2 py-1 rounded-full font-medium",r.bgColor,r.textColor),children:t(`behavior.category.${s.category}`)||s.category})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:n("inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium",h.bgColor,h.textColor,`border ${h.borderColor}`),children:[e.jsx(h.icon,{className:"h-3 w-3 mr-1"}),t(`behavior.severity.${s.severity}`)||s.severity]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs",children:e.jsx("p",{className:"line-clamp-2",children:s.description})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs",children:s.actionTaken?e.jsx("p",{className:"line-clamp-2",children:s.actionTaken}):e.jsx("span",{className:"text-gray-400 italic",children:"-"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((ie=s.reporter)==null?void 0:ie.name)||"System"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:b=>{b.stopPropagation(),te(s)},className:"text-gray-600 hover:text-indigo-600 transition-colors p-1 rounded-md hover:bg-gray-100",title:t("behavior.actions.viewDetail")||"View Detail",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:b=>{b.stopPropagation(),Re(s)},className:"text-gray-600 hover:text-blue-600 transition-colors p-1 rounded-md hover:bg-gray-100",title:t("behavior.actions.edit")||"Edit",children:e.jsx(Ve,{className:"h-4 w-4"})}),e.jsx("button",{onClick:b=>{b.stopPropagation(),De(s)},className:"text-gray-600 hover:text-red-600 transition-colors p-1 rounded-md hover:bg-gray-100",title:t("behavior.actions.delete")||"Delete",children:e.jsx(Le,{className:"h-4 w-4"})})]})})]},s.id)})})]})})}),F&&!o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto animate-fadeIn scrollbar-light",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t("behavior.createNewRecord")||"Create New Record"}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(I,{className:"h-5 w-5"})})]})}),e.jsxs("form",{onSubmit:ke,className:"p-6 space-y-5",children:[!d&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{htmlFor:"student-select",className:"block text-sm font-medium text-gray-700",children:[t("behavior.selectStudent")||"Select Student",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"student-select",value:i.studentId,onChange:Se,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 appearance-none bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[e.jsx("option",{value:"",children:t("behavior.selectStudentPrompt")||"Select a student..."}),je?e.jsx("option",{disabled:!0,children:t("common.loading")||"Loading..."}):E.map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.tingkat||s.grade," ",s.kelas||s.class]},s.id))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx(Ue,{className:"h-5 w-5 text-gray-400"})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.category.label")||"Category"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["attendance","discipline","participation","social"].map(s=>{const r=M[s];return e.jsxs("div",{onClick:()=>u({...i,category:s}),className:n("p-3 rounded-lg border cursor-pointer flex items-center transition-all",i.category===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:n("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.category.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.severity.label")||"Severity"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["positive","neutral","minor","major"].map(s=>{const r=_[s];return e.jsxs("div",{onClick:()=>u({...i,severity:s}),className:n("p-3 rounded-lg border cursor-pointer flex items-center transition-all",i.severity===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:n("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.severity.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.description")||"Description"}),e.jsx("textarea",{value:i.description,onChange:s=>u({...i,description:s.target.value}),rows:3,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.descriptionPlaceholder")||"Describe the behavior..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action Taken",e.jsxs("span",{className:"text-gray-400 text-xs ml-1",children:["(",t("common.optional")||"Optional",")"]})]}),e.jsx("textarea",{value:i.actionTaken||"",onChange:s=>u({...i,actionTaken:s.target.value}),rows:2,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.actionTakenPlaceholder")||"Describe any actions taken..."})]}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-3 border-t mt-6",children:[e.jsx("button",{type:"button",onClick:()=>C(!1),className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:t("common.cancel")||"Cancel"}),e.jsx("button",{type:"submit",disabled:f||!i.description.trim(),className:n("px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white","bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","transition-all duration-200",(f||!i.description.trim())&&"opacity-50 cursor-not-allowed"),children:f?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t("common.saving")||"Saving..."]}):t("common.save")||"Save"})]})]})]})}),be&&!o&&m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t("behavior.editRecord")||"Edit Record"}),e.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(I,{className:"h-5 w-5"})})]})}),e.jsxs("form",{onSubmit:Te,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.category.label")||"Category"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["attendance","discipline","participation","social"].map(s=>{const r=M[s];return e.jsxs("div",{onClick:()=>y({...m,category:s}),className:n("p-3 rounded-lg border cursor-pointer flex items-center transition-all",m.category===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:n("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.category.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.severity.label")||"Severity"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["positive","neutral","minor","major"].map(s=>{const r=_[s];return e.jsxs("div",{onClick:()=>y({...m,severity:s}),className:n("p-3 rounded-lg border cursor-pointer flex items-center transition-all",m.severity===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:n("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.severity.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.description")||"Description"}),e.jsx("textarea",{value:m.description,onChange:s=>y({...m,description:s.target.value}),rows:3,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.descriptionPlaceholder")||"Describe the behavior..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action Taken",e.jsxs("span",{className:"text-gray-400 text-xs ml-1",children:["(",t("common.optional")||"Optional",")"]})]}),e.jsx("textarea",{value:m.actionTaken||"",onChange:s=>y({...m,actionTaken:s.target.value}),rows:2,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.actionTakenPlaceholder")||"Describe any actions taken..."})]}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-3 border-t mt-6",children:[e.jsx("button",{type:"button",onClick:()=>R(!1),className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:t("common.cancel")||"Cancel"}),e.jsx("button",{type:"submit",disabled:f||!m.description.trim(),className:n("px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white","bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","transition-all duration-200",(f||!m.description.trim())&&"opacity-50 cursor-not-allowed"),children:f?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t("common.updating")||"Updating..."]}):t("common.update")||"Update"})]})]})]})}),ve&&!o&&c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-red-600",children:t("behavior.confirmDelete")||"Confirm Delete"}),e.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(I,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-700 mb-4",children:t("behavior.deleteWarning")||"Are you sure you want to delete this behavior record? This action cannot be undone."}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsxs("span",{className:"font-medium",children:[t("behavior.date")||"Date",":"]})," ",P(new Date(c.date),"PPP")]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.jsxs("span",{className:"font-medium",children:[t("behavior.description")||"Description",":"]})," ",c.description]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>D(!1),className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:t("common.cancel")||"Cancel"}),e.jsx("button",{onClick:Ee,disabled:q,className:n("px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white","bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500","transition-colors",q&&"opacity-50 cursor-not-allowed"),children:q?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t("common.deleting")||"Deleting..."]}):t("common.delete")||"Delete"})]})]})}),fe&&c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t("behavior.recordDetails")||"Record Details"}),e.jsx("button",{onClick:()=>L(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(I,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.date")||"Date",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:P(new Date(c.date),"PPP")})]}),"              ",e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.student")||"Student",":"]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((re=E.find(s=>s.id===c.studentId))==null?void 0:re.name)||((ae=c.student)==null?void 0:ae.name)||c.studentId}),(()=>{const s=E.find(r=>r.id===c.studentId);return s&&(s.tingkat||s.kelas||s.grade||s.class)?e.jsxs("div",{className:"text-sm text-gray-600",children:[s.tingkat||s.grade," ",s.kelas||s.class]}):null})()]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.category")||"Category",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:t(`behavior.category.${c.category}`)||c.category})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.severity")||"Severity",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:t(`behavior.severity.${c.severity}`)||c.severity})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.description")||"Description",":"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-line",children:c.description})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action Taken",":"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-line",children:c.actionTaken||"-"})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.reportedBy")||"Reported By",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:((oe=c.reporter)==null?void 0:oe.name)||"System"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>L(!1),className:"w-full px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 transition-colors",children:t("common.close")||"Close"})})]})})]})}export{Ye as default};
