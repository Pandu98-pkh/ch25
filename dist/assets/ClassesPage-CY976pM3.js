import{u as X,j as e,c as T,a as W,d as Z}from"./index-DSnDXcoI.js";import{r as o,u as J}from"./react-vendor-BzbKlFBU.js";import{a as ee,g as se,c as ae,s as te}from"./classService-6RIN8FzF.js";import{T as R,l as re,U as le,t as ne,n as F,Z as k,k as P,X as de,Q as ie,V as oe,_ as G,A as ce,Y as me,K as xe}from"./ui-vendor-BdkMv6fW.js";const K={X:{bg:"bg-blue-50",text:"text-blue-700",gradient:"from-blue-500 to-cyan-400",border:"border-blue-200"},XI:{bg:"bg-purple-50",text:"text-purple-700",gradient:"from-purple-500 to-pink-400",border:"border-purple-200"},XII:{bg:"bg-green-50",text:"text-green-700",gradient:"from-green-500 to-emerald-400",border:"border-green-200"},default:{bg:"bg-indigo-50",text:"text-indigo-700",gradient:"from-indigo-500 to-blue-400",border:"border-indigo-200"}};function ue({classItem:a,onClick:N,onDelete:c}){var j;const{t:n}=X(),[w,r]=o.useState(0),[v,g]=o.useState(!0);o.useEffect(()=>{(async()=>{if(a.id)try{g(!0);const C=await ee(a.id);r(C)}catch(C){console.error("Error fetching student count:",C),r(a.studentCount||0)}finally{g(!1)}})()},[a.id,a.studentCount]);const y=i=>{switch(i){case"10":return"X";case"11":return"XI";case"12":return"XII";default:return i}},x=((j=a.gradeLevel.split("-")[0])==null?void 0:j.trim())||a.gradeLevel,d=y(x),l=K[d]||K.default,p=()=>d==="X"?e.jsx(F,{className:"h-5 w-5 text-white"}):d==="XI"?e.jsx(k,{className:"h-5 w-5 text-white"}):d==="XII"?e.jsx(P,{className:"h-5 w-5 text-white"}):e.jsx(k,{className:"h-5 w-5 text-white"});return e.jsxs("div",{className:`relative bg-white rounded-xl shadow-sm hover:shadow-md transition-all duration-300 \r
                transform hover:-translate-y-1 cursor-pointer overflow-hidden group border border-gray-200`,onClick:()=>N(a),children:[e.jsx("div",{className:`h-2 w-full bg-gradient-to-r ${l.gradient}`}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`rounded-lg p-2.5 bg-gradient-to-br ${l.gradient} shadow-sm flex-shrink-0`,children:p()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 group-hover:text-indigo-700 transition-colors duration-200",children:a.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[c&&e.jsx("button",{onClick:i=>{i.stopPropagation(),c(a)},className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-all duration-200 opacity-0 group-hover:opacity-100",title:n("actions.delete")||"Hapus",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsx("div",{className:T("px-3 py-1 rounded-full text-xs font-semibold",l.bg,l.text,`border ${l.border}`),children:d||a.gradeLevel})]})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:a.gradeLevel})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:`p-3 rounded-lg ${l.bg} border ${l.border} transition-all duration-200`,children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(re,{className:`h-4 w-4 mr-2 ${l.text}`}),e.jsx("span",{className:"text-gray-600",children:n("classes.academicYear")})]}),e.jsx("p",{className:`font-semibold mt-1 ${l.text}`,children:a.academicYear})]}),e.jsxs("div",{className:`p-3 rounded-lg ${l.bg} border ${l.border} transition-all duration-200`,children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(le,{className:`h-4 w-4 mr-2 ${l.text}`}),e.jsx("span",{className:"text-gray-600",children:n("classes.students")})]}),e.jsx("p",{className:`font-semibold mt-1 ${l.text}`,children:v?e.jsx("span",{className:"text-gray-400",children:"..."}):e.jsxs(e.Fragment,{children:[w,a.studentCount&&e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["/ ",a.studentCount]}),e.jsx("span",{className:"text-xs ml-1",children:n("classes.studentsShort")})]})})]})]}),a.teacherName&&e.jsxs("div",{className:"mt-3 flex items-center p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"mr-3 h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(ne,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:n("classes.teacher")}),e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.teacherName})]})]})]}),e.jsx("div",{className:`absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r opacity-0 group-hover:opacity-100 transition-opacity duration-300 ${l.gradient}`})]})}function ge({onClose:a,onSubmit:N}){const{t:c}=X(),[n,w]=o.useState({name:"",gradeLevel:"",academicYear:`${new Date().getFullYear()}/${new Date().getFullYear()+1}`,studentCount:0,teacherName:"",schoolId:"",classId:""}),[r,v]=o.useState({}),g=d=>{const{name:l,value:p}=d.target;w(j=>({...j,[l]:l==="studentCount"?parseInt(p)||0:p})),r[l]&&v(j=>{const i={...j};return delete i[l],i})},y=()=>{const d={};return n.name.trim()||(d.name=c("validation.required")),n.gradeLevel.trim()||(d.gradeLevel=c("validation.required")),n.academicYear.trim()||(d.academicYear=c("validation.required")),v(d),Object.keys(d).length===0},x=d=>{d.preventDefault(),y()&&N(n)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:c("classes.addNew")}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700",children:e.jsx(de,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:x,className:"p-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[c("classes.name"),"*"]}),e.jsx("input",{type:"text",name:"name",value:n.name,onChange:g,className:`w-full px-3 py-2 border ${r.name?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500`}),r.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.name})]}),"            ",e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[c("classes.gradeLevel"),"*"]}),e.jsxs("select",{name:"gradeLevel",value:n.gradeLevel,onChange:g,className:`w-full px-3 py-2 border ${r.gradeLevel?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500`,children:[e.jsx("option",{value:"",children:"Pilih tingkat kelas"}),e.jsx("option",{value:"10",children:"Kelas 10 (X)"}),e.jsx("option",{value:"11",children:"Kelas 11 (XI)"}),e.jsx("option",{value:"12",children:"Kelas 12 (XII)"})]}),r.gradeLevel&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.gradeLevel})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[c("classes.academicYear"),"*"]}),e.jsx("input",{type:"text",name:"academicYear",value:n.academicYear,onChange:g,className:`w-full px-3 py-2 border ${r.academicYear?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500`}),r.academicYear&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.academicYear})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c("classes.teacherName")}),"              ",e.jsx("input",{type:"text",name:"teacherName",value:n.teacherName,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500"})]}),"            ",e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c("classes.maxStudents","Kuota Maksimal Siswa")}),e.jsx("input",{type:"number",name:"studentCount",value:n.studentCount,onChange:g,min:"1",max:"50",placeholder:"Contoh: 30",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Masukkan jumlah maksimal siswa yang dapat diterima di kelas ini"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[c("classes.schoolId","ID Sekolah")," (Opsional)"]}),e.jsx("input",{type:"text",name:"schoolId",value:n.schoolId,onChange:g,className:`w-full px-3 py-2 border ${r.schoolId?"border-red-500":"border-gray-300"} rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500`,placeholder:"Akan dibuat otomatis jika dikosongkan"}),r.schoolId&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.schoolId})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:c("actions.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-brand-600 hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500",children:c("actions.save")})]})]})]})})}function je(){const[a,N]=o.useState(""),[c,n]=o.useState(!1),[w,r]=o.useState([]),[v,g]=o.useState(!0),[y,x]=o.useState(null),[d,l]=o.useState(1),[p,j]=o.useState(1),[i,C]=o.useState("all"),[M,B]=o.useState(0),[E,$]=o.useState(null),[b,S]=o.useState(null),_=3,{t}=X(),A=J(),D=s=>{switch(s){case"X":return"10";case"XI":return"11";case"XII":return"12";case"all":return;default:return}},L=o.useCallback(async()=>{var m,h;const{clearTimeout:s}=W(15e3);try{g(!0),x(null);const u={};if(a&&(u.searchQuery=a),i!=="all"){const Y=D(i);Y&&(u.grade=Y)}const f=await se(u,d);s(),f&&f.data?(r(f.data),j(f.totalPages||1)):(x(t("errors.invalidData")||"Data tidak valid"),r([]))}catch(u){if(Z.isAxiosError(u)){const f=u;f.code==="ERR_CANCELED"?x(t("errors.timeout")||"Permintaan timeout"):x(((h=(m=f.response)==null?void 0:m.data)==null?void 0:h.detail)||t("errors.loadingClasses")||"Gagal memuat data kelas")}else x(t("errors.loadingClasses")||"Gagal memuat data kelas");r([])}finally{g(!1)}},[d,t,a,i]);o.useEffect(()=>{L()},[L]);const q=async s=>{var m,h;try{x(null);const u=await ae(s);r(f=>[...f,u]),n(!1)}catch(u){x(((h=(m=u.response)==null?void 0:m.data)==null?void 0:h.detail)||t("errors.creatingClass")||"Gagal membuat data kelas")}},H=s=>{A(`/app/classes/${s.id}/students`)},O=async s=>{S(s)},U=async()=>{var s,m;if(b!=null&&b.id)try{$(b.id),await te(b.id),r(h=>h.filter(u=>u.id!==b.id)),S(null)}catch(h){x(((m=(s=h.response)==null?void 0:s.data)==null?void 0:m.detail)||t("errors.deletingClass")||"Gagal menghapus kelas")}finally{$(null)}},z=()=>{M<_?(B(s=>s+1),L()):x(t("errors.maxRetriesReached")||"Batas percobaan telah tercapai")},Q=s=>{C(m=>m===s?"all":s)},I=w.filter(s=>{const m=s.name.toLowerCase().includes(a.toLowerCase()),h=i==="all"||s.gradeLevel===D(i)||s.gradeLevel.split(" ")[0]===i;return m&&h}),V=s=>{switch(s){case"X":return e.jsx(F,{className:"h-4 w-4 mr-1"});case"XI":return e.jsx(k,{className:"h-4 w-4 mr-1"});case"XII":return e.jsx(P,{className:"h-4 w-4 mr-1"})}};return e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-indigo-800 w-12 h-12 rounded-lg flex items-center justify-center shadow-lg mr-4",children:e.jsx(k,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 to-purple-600",children:t("classes.title")||"Kelas"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t("classes.subtitle")||"Kelola dan pantau kelas dan siswa"})]})]})}),e.jsx("div",{className:"mb-6 bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ie,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:t("classes.search")||"Cari kelas...",value:a,onChange:s=>N(s.target.value),className:"pl-10 pr-4 py-2.5 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"bg-gray-100 p-1 rounded-lg flex",children:["X","XI","XII"].map(s=>e.jsxs("button",{onClick:()=>Q(s),className:T("px-3 py-1.5 rounded-md text-sm font-medium flex items-center transition-all duration-200",i===s?"bg-indigo-600 text-white shadow-sm transform scale-105":"bg-transparent text-gray-700 hover:bg-gray-200"),children:[V(s),s]},s))}),"            "]}),e.jsxs("button",{onClick:()=>A("/app/classes/deleted"),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 shadow-sm transition-all duration-200",children:[e.jsx(oe,{className:"h-5 w-5 mr-2"}),t("classes.viewDeleted")||"Lihat Kelas Terhapus"]}),e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-700 hover:to-indigo-800 shadow-sm transition-all duration-200 transform hover:scale-105",children:[e.jsx(G,{className:"h-5 w-5 mr-2"}),t("classes.add")||"Tambah Kelas"]})]})]})}),y&&e.jsxs("div",{className:"mb-6 bg-red-50 rounded-xl shadow-sm border border-red-200 overflow-hidden",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 text-red-500 mr-3"}),e.jsx("p",{className:"text-red-700 font-medium",children:y})]}),e.jsxs("button",{onClick:z,className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition-colors duration-200",children:[e.jsx(me,{className:"h-4 w-4 mr-2 animate-spin-slow"}),t("actions.retry")||"Coba lagi"]})]})}),e.jsx("div",{className:"h-1 w-full bg-gradient-to-r from-red-500 to-red-300"})]}),v?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,m)=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5 overflow-hidden",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-2 bg-gradient-to-r from-indigo-400 to-purple-400 w-full rounded-t-xl absolute top-0 left-0"}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"rounded-lg bg-gray-200 h-12 w-12"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"h-16 bg-gray-200 rounded"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded"})]}),e.jsx("div",{className:"mt-3 h-12 bg-gray-200 rounded"})]})},m))}):e.jsxs(e.Fragment,{children:[I.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"bg-gray-100 w-16 h-16 rounded-full mx-auto flex items-center justify-center mb-4",children:e.jsx(xe,{className:"h-8 w-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:a||i!=="all"?t("classes.noResults")||"Tidak ada hasil yang cocok":t("classes.noClasses")||"Belum ada data kelas"}),!a&&i==="all"&&e.jsxs("button",{onClick:()=>n(!0),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-700 hover:to-indigo-800 shadow-sm transition-all duration-200",children:[e.jsx(G,{className:"h-5 w-5 mr-2"}),t("classes.add")||"Tambah Kelas"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map(s=>e.jsx(ue,{classItem:s,onClick:H,onDelete:O},s.id))}),p>1&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsxs("nav",{className:"inline-flex rounded-lg shadow-sm bg-white border border-gray-200 overflow-hidden divide-x divide-gray-200",children:[e.jsx("button",{onClick:()=>l(s=>Math.max(1,s-1)),disabled:d===1,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors duration-200",children:t("pagination.previous")||"Sebelumnya"}),e.jsxs("div",{className:"px-4 py-2 bg-gray-50 text-sm font-medium text-gray-700",children:[d," / ",p]}),e.jsx("button",{onClick:()=>l(s=>Math.min(p,s+1)),disabled:d===p,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors duration-200",children:t("pagination.next")||"Berikutnya"})]})})]}),"      ",c&&e.jsx(ge,{onClose:()=>n(!1),onSubmit:q}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-2 mr-3",children:e.jsx(R,{className:"h-6 w-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t("classes.confirmDelete")||"Konfirmasi Hapus Kelas"})]}),e.jsxs("p",{className:"text-gray-600 mb-6",children:[t("classes.deleteWarning")||"Apakah Anda yakin ingin menghapus kelas"," ",e.jsx("strong",{children:b.name}),"?",t("classes.deleteNote")||" Kelas akan dipindahkan ke tempat sampah dan dapat dipulihkan nanti."]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>S(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200",children:t("actions.cancel")||"Batal"}),e.jsx("button",{onClick:U,disabled:E===b.id,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors duration-200 disabled:opacity-50",children:E===b.id?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),t("actions.deleting")||"Menghapus..."]}):t("actions.delete")||"Hapus"})]})]})})})]})}export{je as default};
