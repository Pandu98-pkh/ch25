import{m as M,u as ke,o as Se,b as Re,a as Te,j as e,c as n}from"./index-BPryJHl5.js";import{r as l}from"./react-vendor-Brf1c7dg.js";import{t as b}from"./toast-M3i0mrg7.js";import{y as re,A as w,Y as De,z as ie,r as G,Q as Ee,_ as ae,U as Ie,E as ne,s as P,v as Pe,a1 as Ae,J as $e,T as Be,X as A,D as Me}from"./ui-vendor-iM6TVctI.js";const oe=async(a={})=>{var t,o,d,C,S;try{console.log("✅ Fetching behavior records from database only");const g=new URLSearchParams;a.studentId&&g.append("studentId",a.studentId),a.page&&g.append("page",a.page.toString()),a.limit&&g.append("limit",a.limit.toString());const p=await M.get(`/behavior/records?${g.toString()}`);return{data:((t=p.data)==null?void 0:t.data)||p.data||[],count:((o=p.data)==null?void 0:o.count)||((d=p.data)==null?void 0:d.length)||0,totalPages:((C=p.data)==null?void 0:C.totalPages)||1,currentPage:((S=p.data)==null?void 0:S.currentPage)||a.page||1}}catch(g){throw console.error("❌ Error fetching behavior records from database:",g),g}},ze=async a=>{try{console.log("✅ Creating behavior record in database");const t={student_id:a.studentId,incident:a.incident,severity:a.severity,category:a.category,date:a.date,reported_by:a.reportedBy,action_taken:a.actionTaken||"",notes:a.notes||""},o=await M.post("/behavior/records",t);return console.log("✅ Behavior record created successfully:",o.data),o}catch(t){throw console.error("❌ Error creating behavior record:",t),t}},Fe=async(a,t)=>{try{console.log("✅ Updating behavior record in database");const o={student_id:t.studentId,incident:t.incident,severity:t.severity,category:t.category,date:t.date,reported_by:t.reportedBy,action_taken:t.actionTaken||"",notes:t.notes||""},d=await M.put(`/behavior/records/${a}`,o);return console.log("✅ Behavior record updated successfully:",d.data),d}catch(o){throw console.error("❌ Error updating behavior record:",o),o}},Oe=async a=>{try{console.log("✅ Deleting behavior record from database");const t=await M.delete(`/behavior/records/${a}`);return console.log("✅ Behavior record deleted successfully:",t.data),t}catch(t){throw console.error("❌ Error deleting behavior record:",t),t}},$={positive:{bgColor:"bg-green-50",textColor:"text-green-700",borderColor:"border-green-200",gradient:"from-green-500 to-teal-400",icon:ie},neutral:{bgColor:"bg-gray-50",textColor:"text-gray-700",borderColor:"border-gray-200",gradient:"from-gray-400 to-gray-300",icon:ne},minor:{bgColor:"bg-yellow-50",textColor:"text-yellow-700",borderColor:"border-yellow-200",gradient:"from-yellow-500 to-amber-400",icon:G},major:{bgColor:"bg-red-50",textColor:"text-red-700",borderColor:"border-red-200",gradient:"from-red-500 to-rose-400",icon:w}},B={attendance:{icon:G,bgColor:"bg-blue-50",textColor:"text-blue-700",borderColor:"border-blue-200"},discipline:{icon:w,bgColor:"bg-purple-50",textColor:"text-purple-700",borderColor:"border-purple-200"},participation:{icon:ne,bgColor:"bg-green-50",textColor:"text-green-700",borderColor:"border-green-200"},social:{icon:Ie,bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"}};function qe({studentId:a}){var ee,se;const{t}=ke(),{user:o,isStudent:d}=Se(),[C,S]=l.useState(""),[g,p]=l.useState([]),[le,H]=l.useState(!0),[X,y]=l.useState(null),[z,k]=l.useState(!1),[f,R]=l.useState(!1),[F,de]=l.useState("all"),[ce,T]=l.useState(!1),[me,D]=l.useState(!1),[xe,O]=l.useState(!1),[x,_]=l.useState(null),[c,j]=l.useState(null),[L,J]=l.useState(!1),Q=a||(d?o==null?void 0:o.id:""),[E,U]=l.useState(Q||""),[V,he]=l.useState([]),[ge,Y]=l.useState(!1),[pe,ue]=l.useState(0),be=3,[i,u]=l.useState({studentId:Q||"",category:"discipline",severity:"neutral",description:"",actionTaken:""}),K=l.useCallback(async()=>{if(!(a||d))try{Y(!0);const s=await Re({},1);s&&s.data&&he(s.data)}catch(s){console.error("Error loading students:",s)}finally{Y(!1)}},[a,d]),N=l.useCallback(async()=>{try{H(!0),y(null);const{clearTimeout:s}=Te(15e3);let r;d&&E?r=await oe({studentId:E}):r=await oe({}),s(),r&&r.data?p(r.data):(y(t("errors.invalidData")||"Format respons tidak valid"),p([]))}catch(s){console.error("Error loading behavior records:",s),s instanceof Error?s.name==="AbortError"||s.message.includes("timeout")?y(t("errors.timeout")||"Waktu permintaan habis"):y(s.message||t("errors.loadingRecords")||"Gagal memuat data"):y(t("errors.loadingRecords")||"Gagal memuat data"),p([])}finally{H(!1)}},[E,d,t]),ve=async s=>{if(s.preventDefault(),!i.studentId){b.error(t("behavior.noStudentSelected")||"Silakan pilih siswa terlebih dahulu");return}if(!i.description.trim()){b.error(t("behavior.descriptionRequired")||"Deskripsi tidak boleh kosong");return}try{R(!0);const r={studentId:i.studentId,incident:i.description,severity:i.severity==="positive"||i.severity==="neutral"?"minor":"major",category:i.severity==="positive"?"positive":"negative",date:new Date().toISOString().split("T")[0],reportedBy:(o==null?void 0:o.name)||"System",actionTaken:i.actionTaken||"",notes:i.description};if(await ze(r))b.success(t("behavior.recordCreated")||"Catatan berhasil dibuat"),k(!1),i.studentId!==E?U(i.studentId):N(),u({studentId:i.studentId,category:"discipline",severity:"neutral",description:"",actionTaken:""});else throw new Error("Failed to create record")}catch(r){console.error("Error creating behavior record:",r),b.error(r instanceof Error?r.message:t("behavior.createFailed")||"Gagal membuat catatan")}finally{R(!1)}},ye=s=>{const r=s.target.value;u({...i,studentId:r})},Z=s=>{_(s),O(!0)},fe=s=>{j({...s}),T(!0)},je=s=>{_(s),D(!0)},Ne=async s=>{if(s.preventDefault(),!!c)try{R(!0),await Fe(c.id,{studentId:c.studentId,incident:c.description,severity:c.severity==="positive"||c.severity==="neutral"?"minor":"major",category:c.severity==="positive"?"positive":"negative",date:c.date,reportedBy:(o==null?void 0:o.name)||"System",actionTaken:c.actionTaken,notes:c.description}),b.success(t("behavior.recordUpdated")||"Record updated successfully"),T(!1),j(null),N()}catch(r){console.error("Error updating behavior record:",r),b.error(r instanceof Error?r.message:t("behavior.updateFailed")||"Failed to update record")}finally{R(!1)}},we=async()=>{if(x)try{J(!0),await Oe(x.id),b.success(t("behavior.recordDeleted")||"Record deleted successfully"),D(!1),_(null),N()}catch(s){console.error("Error deleting behavior record:",s),b.error(s instanceof Error?s.message:t("behavior.deleteFailed")||"Failed to delete record")}finally{J(!1)}},Ce=()=>{pe<be?(ue(s=>s+1),N()):y(t("errors.maxRetriesReached")||"Batas percobaan telah tercapai")};l.useEffect(()=>{N()},[N]),l.useEffect(()=>{if(a)U(a),u(s=>({...s,studentId:a}));else if(d&&(o!=null&&o.id)){const s=o.id;U(s),u(r=>({...r,studentId:s}))}},[a,d,o==null?void 0:o.id]),l.useEffect(()=>{z&&K()},[z,K]);const W=g.filter(s=>{const r=s.description.toLowerCase().includes(C.toLowerCase()),h=F==="all"||s.category===F;return r&&h}),I=(()=>{const s=g.filter(m=>new Date(m.date).getMonth()===new Date().getMonth()),r=g.filter(m=>m.severity==="positive"),h=g.filter(m=>m.severity==="major");return{thisMonth:s.length,positive:r.length,needsAttention:h.length,total:g.length}})();return le?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-700 w-12 h-12 rounded-lg flex items-center justify-center shadow-lg mr-4 animate-pulse",children:e.jsx(re,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 w-48 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 w-64 bg-gray-200 rounded"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((s,r)=>e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm animate-pulse border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-200 mr-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded"})]})]})},r))}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsx("div",{className:"animate-pulse space-y-6",children:[...Array(3)].map((s,r)=>e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-gray-200 rounded-full"})]}),e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded"})]},r))})})]}):X?e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-xl border border-red-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-2",children:e.jsx(w,{className:"h-6 w-6 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-red-700",children:t("behavior.errorLoading")||"Gagal memuat catatan perilaku"})]}),e.jsx("p",{className:"text-red-600 mb-6 pl-11",children:X}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:Ce,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors shadow-sm",children:[e.jsx(De,{className:"h-4 w-4 mr-2 animate-spin-slow"}),t("actions.retry")||"Coba Lagi"]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-700 w-12 h-12 rounded-lg flex items-center justify-center shadow-lg mr-4",children:e.jsx(re,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600",children:d?t("behavior.studentTitle")||"My Behavior Records":t("behavior.title")||"Behavior Records"}),e.jsx("p",{className:"text-gray-500 mt-1",children:d?t("behavior.studentSubtitle")||"View your behavior history and patterns":t("behavior.subtitle")||"Track and manage student behavior patterns"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-indigo-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg mr-4",children:e.jsx(w,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.total")||"Total Records"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:I.total})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-green-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-50 rounded-lg mr-4",children:e.jsx(ie,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.positive")||"Positive"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-green-600",children:I.positive})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-blue-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg mr-4",children:e.jsx(G,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.thisMonth")||"This Month"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-blue-600",children:I.thisMonth})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-red-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-red-50 rounded-lg mr-4",children:e.jsx(w,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.needsAttention")||"Needs Attention"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-red-600",children:I.needsAttention})]})]})})]}),e.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ee,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:t("behavior.search")||"Search records...",value:C,onChange:s=>S(s.target.value),className:"pl-10 pr-4 py-2.5 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"bg-gray-100 p-1 rounded-lg flex",children:["all","attendance","discipline","participation","social"].map(s=>e.jsx("button",{onClick:()=>de(s),className:n("px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200",F===s?"bg-indigo-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-200"),children:s==="all"?t("behavior.all")||"All":t(`behavior.category.${s}`)||s},s))}),!d&&e.jsxs("button",{onClick:()=>k(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 shadow-sm transition-all duration-200 transform hover:scale-105",children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),t("behavior.newRecord")||"New Record"]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:W.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"mx-auto h-20 w-20 text-gray-400 mb-4",children:e.jsx(w,{className:"h-full w-full"})}),e.jsx("p",{className:"text-gray-500 font-medium mb-4",children:t("behavior.noRecordsFound")||"No records found"}),!d&&e.jsxs("button",{onClick:()=>k(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 shadow-sm transition-colors",children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),t("behavior.addFirstRecord")||"Add First Record"]})]}):d?e.jsx("div",{className:"divide-y divide-gray-200",children:W.map(s=>{var m;const r=B[s.category],h=$[s.severity];return e.jsx("div",{className:"group hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:n("p-2 rounded-lg",r.bgColor),children:e.jsx(r.icon,{className:n("h-5 w-5",r.textColor)})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:P(new Date(s.date),"PPP")}),e.jsx("span",{className:n("ml-2 text-xs px-2 py-0.5 rounded-full font-medium",r.bgColor,r.textColor),children:t(`behavior.category.${s.category}`)||s.category})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:s.description})]})]}),e.jsxs("div",{className:n("px-3 py-1.5 rounded-lg text-xs font-medium flex items-center",h.bgColor,h.textColor,`border ${h.borderColor}`),children:[e.jsx(h.icon,{className:"h-4 w-4 mr-1.5"}),t(`behavior.severity.${s.severity}`)||s.severity]})]}),s.actionTaken&&e.jsx("div",{className:"mt-4 pl-11",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action:",":"]})," ",s.actionTaken]})}),e.jsxs("div",{className:"mt-4 pl-11 flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[t("behavior.reportedBy")||"Reported by",": ",((m=s.reporter)==null?void 0:m.name)||"System"]}),e.jsxs("button",{onClick:q=>{q.stopPropagation(),Z(s)},className:"opacity-0 group-hover:opacity-100 transition-opacity text-sm font-medium text-indigo-600 hover:text-indigo-700 flex items-center",children:[t("behavior.viewDetails")||"View Details",e.jsx(Pe,{className:"h-4 w-4 ml-1.5"})]})]})]})},s.id)})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.date")||"Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.student")||"Student"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.category")||"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.severity")||"Severity"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.description")||"Description"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.actionTaken")||"Action Taken"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.reporter")||"Reported By"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.actions")||"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W.map(s=>{var te;const r=B[s.category],h=$[s.severity],m=V.find(v=>v.id===s.studentId),q=(m==null?void 0:m.name)||s.studentId;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:P(new Date(s.date),"dd/MM/yyyy")}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:q}),m&&e.jsxs("div",{className:"text-sm text-gray-500",children:[m.tingkat||m.grade," ",m.kelas||m.class]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:n("p-1.5 rounded-lg mr-2",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:n("text-xs px-2 py-1 rounded-full font-medium",r.bgColor,r.textColor),children:t(`behavior.category.${s.category}`)||s.category})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:n("inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium",h.bgColor,h.textColor,`border ${h.borderColor}`),children:[e.jsx(h.icon,{className:"h-3 w-3 mr-1"}),t(`behavior.severity.${s.severity}`)||s.severity]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs",children:e.jsx("p",{className:"line-clamp-2",children:s.description})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs",children:s.actionTaken?e.jsx("p",{className:"line-clamp-2",children:s.actionTaken}):e.jsx("span",{className:"text-gray-400 italic",children:"-"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((te=s.reporter)==null?void 0:te.name)||"System"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:v=>{v.stopPropagation(),Z(s)},className:"text-gray-600 hover:text-indigo-600 transition-colors p-1 rounded-md hover:bg-gray-100",title:t("behavior.actions.viewDetail")||"View Detail",children:e.jsx(Ae,{className:"h-4 w-4"})}),e.jsx("button",{onClick:v=>{v.stopPropagation(),fe(s)},className:"text-gray-600 hover:text-blue-600 transition-colors p-1 rounded-md hover:bg-gray-100",title:t("behavior.actions.edit")||"Edit",children:e.jsx($e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:v=>{v.stopPropagation(),je(s)},className:"text-gray-600 hover:text-red-600 transition-colors p-1 rounded-md hover:bg-gray-100",title:t("behavior.actions.delete")||"Delete",children:e.jsx(Be,{className:"h-4 w-4"})})]})})]},s.id)})})]})})}),z&&!d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto animate-fadeIn scrollbar-light",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t("behavior.createNewRecord")||"Create New Record"}),e.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(A,{className:"h-5 w-5"})})]})}),e.jsxs("form",{onSubmit:ve,className:"p-6 space-y-5",children:[!a&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{htmlFor:"student-select",className:"block text-sm font-medium text-gray-700",children:[t("behavior.selectStudent")||"Select Student",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"student-select",value:i.studentId,onChange:ye,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 appearance-none bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[e.jsx("option",{value:"",children:t("behavior.selectStudentPrompt")||"Select a student..."}),ge?e.jsx("option",{disabled:!0,children:t("common.loading")||"Loading..."}):V.map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.tingkat||s.grade," ",s.kelas||s.class]},s.id))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx(Me,{className:"h-5 w-5 text-gray-400"})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.category.label")||"Category"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["attendance","discipline","participation","social"].map(s=>{const r=B[s];return e.jsxs("div",{onClick:()=>u({...i,category:s}),className:n("p-3 rounded-lg border cursor-pointer flex items-center transition-all",i.category===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:n("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.category.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.severity.label")||"Severity"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["positive","neutral","minor","major"].map(s=>{const r=$[s];return e.jsxs("div",{onClick:()=>u({...i,severity:s}),className:n("p-3 rounded-lg border cursor-pointer flex items-center transition-all",i.severity===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:n("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.severity.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.description")||"Description"}),e.jsx("textarea",{value:i.description,onChange:s=>u({...i,description:s.target.value}),rows:3,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.descriptionPlaceholder")||"Describe the behavior..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action Taken",e.jsxs("span",{className:"text-gray-400 text-xs ml-1",children:["(",t("common.optional")||"Optional",")"]})]}),e.jsx("textarea",{value:i.actionTaken||"",onChange:s=>u({...i,actionTaken:s.target.value}),rows:2,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.actionTakenPlaceholder")||"Describe any actions taken..."})]}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-3 border-t mt-6",children:[e.jsx("button",{type:"button",onClick:()=>k(!1),className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:t("common.cancel")||"Cancel"}),e.jsx("button",{type:"submit",disabled:f||!i.description.trim(),className:n("px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white","bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","transition-all duration-200",(f||!i.description.trim())&&"opacity-50 cursor-not-allowed"),children:f?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t("common.saving")||"Saving..."]}):t("common.save")||"Save"})]})]})]})}),ce&&!d&&c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t("behavior.editRecord")||"Edit Record"}),e.jsx("button",{onClick:()=>T(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(A,{className:"h-5 w-5"})})]})}),e.jsxs("form",{onSubmit:Ne,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.category.label")||"Category"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["attendance","discipline","participation","social"].map(s=>{const r=B[s];return e.jsxs("div",{onClick:()=>j({...c,category:s}),className:n("p-3 rounded-lg border cursor-pointer flex items-center transition-all",c.category===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:n("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.category.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.severity.label")||"Severity"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["positive","neutral","minor","major"].map(s=>{const r=$[s];return e.jsxs("div",{onClick:()=>j({...c,severity:s}),className:n("p-3 rounded-lg border cursor-pointer flex items-center transition-all",c.severity===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:n("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:n("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.severity.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.description")||"Description"}),e.jsx("textarea",{value:c.description,onChange:s=>j({...c,description:s.target.value}),rows:3,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.descriptionPlaceholder")||"Describe the behavior..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action Taken",e.jsxs("span",{className:"text-gray-400 text-xs ml-1",children:["(",t("common.optional")||"Optional",")"]})]}),e.jsx("textarea",{value:c.actionTaken||"",onChange:s=>j({...c,actionTaken:s.target.value}),rows:2,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.actionTakenPlaceholder")||"Describe any actions taken..."})]}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-3 border-t mt-6",children:[e.jsx("button",{type:"button",onClick:()=>T(!1),className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:t("common.cancel")||"Cancel"}),e.jsx("button",{type:"submit",disabled:f||!c.description.trim(),className:n("px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white","bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","transition-all duration-200",(f||!c.description.trim())&&"opacity-50 cursor-not-allowed"),children:f?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t("common.updating")||"Updating..."]}):t("common.update")||"Update"})]})]})]})}),me&&!d&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-red-600",children:t("behavior.confirmDelete")||"Confirm Delete"}),e.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(A,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-700 mb-4",children:t("behavior.deleteWarning")||"Are you sure you want to delete this behavior record? This action cannot be undone."}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsxs("span",{className:"font-medium",children:[t("behavior.date")||"Date",":"]})," ",P(new Date(x.date),"PPP")]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.jsxs("span",{className:"font-medium",children:[t("behavior.description")||"Description",":"]})," ",x.description]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>D(!1),className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:t("common.cancel")||"Cancel"}),e.jsx("button",{onClick:we,disabled:L,className:n("px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white","bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500","transition-colors",L&&"opacity-50 cursor-not-allowed"),children:L?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t("common.deleting")||"Deleting..."]}):t("common.delete")||"Delete"})]})]})}),xe&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t("behavior.recordDetails")||"Record Details"}),e.jsx("button",{onClick:()=>O(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(A,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.date")||"Date",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:P(new Date(x.date),"PPP")})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.student")||"Student",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:((ee=V.find(s=>s.id===x.studentId))==null?void 0:ee.name)||x.studentId})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.category")||"Category",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:t(`behavior.category.${x.category}`)||x.category})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.severity")||"Severity",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:t(`behavior.severity.${x.severity}`)||x.severity})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.description")||"Description",":"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-line",children:x.description})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action Taken",":"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-line",children:x.actionTaken||"-"})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.reportedBy")||"Reported By",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:((se=x.reporter)==null?void 0:se.name)||"System"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>O(!1),className:"w-full px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 transition-colors",children:t("common.close")||"Close"})})]})})]})}export{qe as default};
