import{m as M,u as Ae,o as Pe,b as Ie,a as _e,j as e,c as i,_ as ie}from"./index-DSnDXcoI.js";import{r as n}from"./react-vendor-BzbKlFBU.js";import{t as p}from"./toast-M3i0mrg7.js";import{y as ne,A as N,Y as Me,z as ce,r as J,Q as $e,_ as le,U as Be,E as me,s as A,v as Oe,a1 as ze,J as Fe,T as Ve,X as P,D as Le}from"./ui-vendor-BdkMv6fW.js";const H=[],Ue=d=>{const t=new Set,l=[];for(const a of d)if(!t.has(a.id))t.add(a.id),l.push(a);else{const g=`${a.id}-${Date.now()}`;t.add(g),l.push({...a,id:g})}return l},xe=!0;let $=!1;const X=async(d,t,l=1)=>{try{if(xe||!$){const g=await M.get("/behavior-records",{params:{student:d,page:l,...t}}),k=Ue(g.data.results||[]);return{data:k,count:g.data.count||k.length,totalPages:g.data.total_pages||1,currentPage:g.data.current_page||l}}let a=H.filter(g=>g.studentId===d);return{data:a,count:a.length,totalPages:1,currentPage:1}}catch(a){throw console.error("Error loading behavior records:",a),a}},he=async d=>{try{if(xe||!$)return(await M.post("/behavior-records",d)).data;const t={...d,id:String(H.length+1)};return H.push(t),t}catch(t){throw console.error("Error creating behavior record:",t),t}},qe=async(d,t)=>{try{return(await M.put(`/behavior-records/${d}`,t)).data}catch(l){throw console.error("Error updating behavior record:",l),l}},We=async d=>{try{await M.delete(`/behavior-records/${d}`)}catch(t){throw console.error("Error deleting behavior record:",t),t}},de=Object.freeze(Object.defineProperty({__proto__:null,createBehaviorRecord:he,deleteBehaviorRecord:We,getBehaviorRecords:X,updateBehaviorRecord:qe},Symbol.toStringTag,{value:"Module"})),I={positive:{bgColor:"bg-green-50",textColor:"text-green-700",borderColor:"border-green-200",gradient:"from-green-500 to-teal-400",icon:ce},neutral:{bgColor:"bg-gray-50",textColor:"text-gray-700",borderColor:"border-gray-200",gradient:"from-gray-400 to-gray-300",icon:me},minor:{bgColor:"bg-yellow-50",textColor:"text-yellow-700",borderColor:"border-yellow-200",gradient:"from-yellow-500 to-amber-400",icon:J},major:{bgColor:"bg-red-50",textColor:"text-red-700",borderColor:"border-red-200",gradient:"from-red-500 to-rose-400",icon:N}},_={attendance:{icon:J,bgColor:"bg-blue-50",textColor:"text-blue-700",borderColor:"border-blue-200"},discipline:{icon:N,bgColor:"bg-purple-50",textColor:"text-purple-700",borderColor:"border-purple-200"},participation:{icon:me,bgColor:"bg-green-50",textColor:"text-green-700",borderColor:"border-green-200"},social:{icon:Be,bgColor:"bg-amber-50",textColor:"text-amber-700",borderColor:"border-amber-200"}};function Qe({studentId:d}){var re,ae;const{t}=Ae(),{user:l,isStudent:a}=Pe(),[g,k]=n.useState(""),[w,B]=n.useState([]),[ge,K]=n.useState(!0),[Q,v]=n.useState(null),[O,C]=n.useState(!1),[f,S]=n.useState(!1),[z,ue]=n.useState("all"),[pe,R]=n.useState(!1),[be,D]=n.useState(!1),[ve,F]=n.useState(!1),[x,V]=n.useState(null),[c,y]=n.useState(null),[L,Y]=n.useState(!1),Z=d||(a?l==null?void 0:l.id:""),[T,U]=n.useState(Z||""),[q,fe]=n.useState([]),[ye,ee]=n.useState(!1),[je,Ne]=n.useState(0),we=3,[o,u]=n.useState({studentId:Z||"",category:"discipline",severity:"neutral",description:"",actionTaken:""}),se=n.useCallback(async()=>{if(!(d||a))try{ee(!0);const s=await Ie({},1);s&&s.data&&fe(s.data)}catch(s){console.error("Error loading students:",s)}finally{ee(!1)}},[d,a]),j=n.useCallback(async()=>{try{K(!0),v(null);const{clearTimeout:s}=_e(15e3);let r;a&&T?r=await X(T):r=await X("",{},1),s(),r&&r.data?B(r.data):(v(t("errors.invalidData")||"Format respons tidak valid"),B([]))}catch(s){console.error("Error loading behavior records:",s),s instanceof Error?s.name==="AbortError"||s.message.includes("timeout")?v(t("errors.timeout")||"Waktu permintaan habis"):v(s.message||t("errors.loadingRecords")||"Gagal memuat data"):v(t("errors.loadingRecords")||"Gagal memuat data"),B([])}finally{K(!1)}},[T,a,t]),Ce=async s=>{if(s.preventDefault(),!o.studentId){p.error(t("behavior.noStudentSelected")||"Silakan pilih siswa terlebih dahulu");return}if(!o.description.trim()){p.error(t("behavior.descriptionRequired")||"Deskripsi tidak boleh kosong");return}try{S(!0);const r={studentId:o.studentId,date:new Date().toISOString().split("T")[0],type:o.severity==="positive"?"positive":"negative",description:o.description,category:o.category,severity:o.severity,reporter:{id:"system",name:"System"},...o.actionTaken?{actionTaken:o.actionTaken}:{}};if(await he(r))p.success(t("behavior.recordCreated")||"Catatan berhasil dibuat"),C(!1),o.studentId!==T?U(o.studentId):j(),u({studentId:o.studentId,category:"discipline",severity:"neutral",description:"",actionTaken:""});else throw new Error("Failed to create record")}catch(r){console.error("Error creating behavior record:",r),p.error(r instanceof Error?r.message:t("behavior.createFailed")||"Gagal membuat catatan")}finally{S(!1)}},ke=s=>{const r=s.target.value;u({...o,studentId:r})},te=s=>{V(s),F(!0)},Se=s=>{y({...s}),R(!0)},Re=s=>{V(s),D(!0)},De=async s=>{if(s.preventDefault(),!!c)try{S(!0);const{updateBehaviorRecord:r}=await ie(async()=>{const{updateBehaviorRecord:h}=await Promise.resolve().then(()=>de);return{updateBehaviorRecord:h}},void 0);await r(c.id,{category:c.category,severity:c.severity,description:c.description,actionTaken:c.actionTaken}),p.success(t("behavior.recordUpdated")||"Record updated successfully"),R(!1),y(null),j()}catch(r){console.error("Error updating behavior record:",r),p.error(r instanceof Error?r.message:t("behavior.updateFailed")||"Failed to update record")}finally{S(!1)}},Te=async()=>{if(x)try{Y(!0);const{deleteBehaviorRecord:s}=await ie(async()=>{const{deleteBehaviorRecord:r}=await Promise.resolve().then(()=>de);return{deleteBehaviorRecord:r}},void 0);await s(x.id),p.success(t("behavior.recordDeleted")||"Record deleted successfully"),D(!1),V(null),j()}catch(s){console.error("Error deleting behavior record:",s),p.error(s instanceof Error?s.message:t("behavior.deleteFailed")||"Failed to delete record")}finally{Y(!1)}},Ee=()=>{je<we?(Ne(s=>s+1),j()):v(t("errors.maxRetriesReached")||"Batas percobaan telah tercapai")};n.useEffect(()=>{j()},[j]),n.useEffect(()=>{if(d)U(d),u(s=>({...s,studentId:d}));else if(a&&(l!=null&&l.id)){const s=l.id;U(s),u(r=>({...r,studentId:s}))}},[d,a,l==null?void 0:l.id]),n.useEffect(()=>{O&&se()},[O,se]);const W=w.filter(s=>{const r=s.description.toLowerCase().includes(g.toLowerCase()),h=z==="all"||s.category===z;return r&&h}),E=(()=>{const s=w.filter(m=>new Date(m.date).getMonth()===new Date().getMonth()),r=w.filter(m=>m.severity==="positive"),h=w.filter(m=>m.severity==="major");return{thisMonth:s.length,positive:r.length,needsAttention:h.length,total:w.length}})();return ge?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-700 w-12 h-12 rounded-lg flex items-center justify-center shadow-lg mr-4 animate-pulse",children:e.jsx(ne,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 w-48 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 w-64 bg-gray-200 rounded"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((s,r)=>e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm animate-pulse border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-gray-200 mr-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded"})]})]})},r))}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsx("div",{className:"animate-pulse space-y-6",children:[...Array(3)].map((s,r)=>e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-gray-200 rounded-full"})]}),e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded"})]},r))})})]}):Q?e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-xl border border-red-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-2",children:e.jsx(N,{className:"h-6 w-6 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-red-700",children:t("behavior.errorLoading")||"Gagal memuat catatan perilaku"})]}),e.jsx("p",{className:"text-red-600 mb-6 pl-11",children:Q}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:Ee,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors shadow-sm",children:[e.jsx(Me,{className:"h-4 w-4 mr-2 animate-spin-slow"}),t("actions.retry")||"Coba Lagi"]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-700 w-12 h-12 rounded-lg flex items-center justify-center shadow-lg mr-4",children:e.jsx(ne,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600",children:a?t("behavior.studentTitle")||"My Behavior Records":t("behavior.title")||"Behavior Records"}),e.jsx("p",{className:"text-gray-500 mt-1",children:a?t("behavior.studentSubtitle")||"View your behavior history and patterns":t("behavior.subtitle")||"Track and manage student behavior patterns"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-indigo-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg mr-4",children:e.jsx(N,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.total")||"Total Records"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:E.total})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-green-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-50 rounded-lg mr-4",children:e.jsx(ce,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.positive")||"Positive"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-green-600",children:E.positive})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-blue-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg mr-4",children:e.jsx(J,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.thisMonth")||"This Month"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-blue-600",children:E.thisMonth})]})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-red-100 hover:shadow transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-red-50 rounded-lg mr-4",children:e.jsx(N,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:t("behavior.stats.needsAttention")||"Needs Attention"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-red-600",children:E.needsAttention})]})]})})]}),e.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx($e,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:t("behavior.search")||"Search records...",value:g,onChange:s=>k(s.target.value),className:"pl-10 pr-4 py-2.5 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"bg-gray-100 p-1 rounded-lg flex",children:["all","attendance","discipline","participation","social"].map(s=>e.jsx("button",{onClick:()=>ue(s),className:i("px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200",z===s?"bg-indigo-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-200"),children:s==="all"?t("behavior.all")||"All":t(`behavior.category.${s}`)||s},s))}),!a&&e.jsxs("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 shadow-sm transition-all duration-200 transform hover:scale-105",children:[e.jsx(le,{className:"h-5 w-5 mr-2"}),t("behavior.newRecord")||"New Record"]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:W.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"mx-auto h-20 w-20 text-gray-400 mb-4",children:e.jsx(N,{className:"h-full w-full"})}),e.jsx("p",{className:"text-gray-500 font-medium mb-4",children:t("behavior.noRecordsFound")||"No records found"}),!a&&e.jsxs("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 shadow-sm transition-colors",children:[e.jsx(le,{className:"h-5 w-5 mr-2"}),t("behavior.addFirstRecord")||"Add First Record"]})]}):a?e.jsx("div",{className:"divide-y divide-gray-200",children:W.map(s=>{var m;const r=_[s.category],h=I[s.severity];return e.jsx("div",{className:"group hover:bg-gray-50 transition-colors duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:i("p-2 rounded-lg",r.bgColor),children:e.jsx(r.icon,{className:i("h-5 w-5",r.textColor)})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:A(new Date(s.date),"PPP")}),e.jsx("span",{className:i("ml-2 text-xs px-2 py-0.5 rounded-full font-medium",r.bgColor,r.textColor),children:t(`behavior.category.${s.category}`)||s.category})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:s.description})]})]}),e.jsxs("div",{className:i("px-3 py-1.5 rounded-lg text-xs font-medium flex items-center",h.bgColor,h.textColor,`border ${h.borderColor}`),children:[e.jsx(h.icon,{className:"h-4 w-4 mr-1.5"}),t(`behavior.severity.${s.severity}`)||s.severity]})]}),s.actionTaken&&e.jsx("div",{className:"mt-4 pl-11",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action:",":"]})," ",s.actionTaken]})}),e.jsxs("div",{className:"mt-4 pl-11 flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:[t("behavior.reportedBy")||"Reported by",": ",((m=s.reporter)==null?void 0:m.name)||"System"]}),e.jsxs("button",{onClick:G=>{G.stopPropagation(),te(s)},className:"opacity-0 group-hover:opacity-100 transition-opacity text-sm font-medium text-indigo-600 hover:text-indigo-700 flex items-center",children:[t("behavior.viewDetails")||"View Details",e.jsx(Oe,{className:"h-4 w-4 ml-1.5"})]})]})]})},s.id)})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.date")||"Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.student")||"Student"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.category")||"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.severity")||"Severity"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.description")||"Description"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.actionTaken")||"Action Taken"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.reporter")||"Reported By"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("behavior.table.actions")||"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W.map(s=>{var oe;const r=_[s.category],h=I[s.severity],m=q.find(b=>b.id===s.studentId),G=(m==null?void 0:m.name)||s.studentId;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:A(new Date(s.date),"dd/MM/yyyy")}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:G}),m&&e.jsxs("div",{className:"text-sm text-gray-500",children:[m.tingkat||m.grade," ",m.kelas||m.class]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:i("p-1.5 rounded-lg mr-2",r.bgColor),children:e.jsx(r.icon,{className:i("h-4 w-4",r.textColor)})}),e.jsx("span",{className:i("text-xs px-2 py-1 rounded-full font-medium",r.bgColor,r.textColor),children:t(`behavior.category.${s.category}`)||s.category})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:i("inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium",h.bgColor,h.textColor,`border ${h.borderColor}`),children:[e.jsx(h.icon,{className:"h-3 w-3 mr-1"}),t(`behavior.severity.${s.severity}`)||s.severity]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs",children:e.jsx("p",{className:"line-clamp-2",children:s.description})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs",children:s.actionTaken?e.jsx("p",{className:"line-clamp-2",children:s.actionTaken}):e.jsx("span",{className:"text-gray-400 italic",children:"-"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((oe=s.reporter)==null?void 0:oe.name)||"System"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:b=>{b.stopPropagation(),te(s)},className:"text-gray-600 hover:text-indigo-600 transition-colors p-1 rounded-md hover:bg-gray-100",title:t("behavior.actions.viewDetail")||"View Detail",children:e.jsx(ze,{className:"h-4 w-4"})}),e.jsx("button",{onClick:b=>{b.stopPropagation(),Se(s)},className:"text-gray-600 hover:text-blue-600 transition-colors p-1 rounded-md hover:bg-gray-100",title:t("behavior.actions.edit")||"Edit",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:b=>{b.stopPropagation(),Re(s)},className:"text-gray-600 hover:text-red-600 transition-colors p-1 rounded-md hover:bg-gray-100",title:t("behavior.actions.delete")||"Delete",children:e.jsx(Ve,{className:"h-4 w-4"})})]})})]},s.id)})})]})})}),O&&!a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto animate-fadeIn scrollbar-light",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t("behavior.createNewRecord")||"Create New Record"}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(P,{className:"h-5 w-5"})})]})}),e.jsxs("form",{onSubmit:Ce,className:"p-6 space-y-5",children:[!d&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{htmlFor:"student-select",className:"block text-sm font-medium text-gray-700",children:[t("behavior.selectStudent")||"Select Student",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"student-select",value:o.studentId,onChange:ke,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 appearance-none bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[e.jsx("option",{value:"",children:t("behavior.selectStudentPrompt")||"Select a student..."}),ye?e.jsx("option",{disabled:!0,children:t("common.loading")||"Loading..."}):q.map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.tingkat||s.grade," ",s.kelas||s.class]},s.id))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx(Le,{className:"h-5 w-5 text-gray-400"})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.category.label")||"Category"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["attendance","discipline","participation","social"].map(s=>{const r=_[s];return e.jsxs("div",{onClick:()=>u({...o,category:s}),className:i("p-3 rounded-lg border cursor-pointer flex items-center transition-all",o.category===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:i("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:i("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.category.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.severity.label")||"Severity"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["positive","neutral","minor","major"].map(s=>{const r=I[s];return e.jsxs("div",{onClick:()=>u({...o,severity:s}),className:i("p-3 rounded-lg border cursor-pointer flex items-center transition-all",o.severity===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:i("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:i("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.severity.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.description")||"Description"}),e.jsx("textarea",{value:o.description,onChange:s=>u({...o,description:s.target.value}),rows:3,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.descriptionPlaceholder")||"Describe the behavior..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action Taken",e.jsxs("span",{className:"text-gray-400 text-xs ml-1",children:["(",t("common.optional")||"Optional",")"]})]}),e.jsx("textarea",{value:o.actionTaken||"",onChange:s=>u({...o,actionTaken:s.target.value}),rows:2,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.actionTakenPlaceholder")||"Describe any actions taken..."})]}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-3 border-t mt-6",children:[e.jsx("button",{type:"button",onClick:()=>C(!1),className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:t("common.cancel")||"Cancel"}),e.jsx("button",{type:"submit",disabled:f||!o.description.trim(),className:i("px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white","bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","transition-all duration-200",(f||!o.description.trim())&&"opacity-50 cursor-not-allowed"),children:f?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t("common.saving")||"Saving..."]}):t("common.save")||"Save"})]})]})]})}),pe&&!a&&c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t("behavior.editRecord")||"Edit Record"}),e.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(P,{className:"h-5 w-5"})})]})}),e.jsxs("form",{onSubmit:De,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.category.label")||"Category"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["attendance","discipline","participation","social"].map(s=>{const r=_[s];return e.jsxs("div",{onClick:()=>y({...c,category:s}),className:i("p-3 rounded-lg border cursor-pointer flex items-center transition-all",c.category===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:i("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:i("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.category.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.severity.label")||"Severity"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["positive","neutral","minor","major"].map(s=>{const r=I[s];return e.jsxs("div",{onClick:()=>y({...c,severity:s}),className:i("p-3 rounded-lg border cursor-pointer flex items-center transition-all",c.severity===s?`${r.borderColor} ${r.bgColor} shadow-sm`:"border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:i("p-2 rounded-lg mr-3",r.bgColor),children:e.jsx(r.icon,{className:i("h-4 w-4",r.textColor)})}),e.jsx("span",{className:"text-sm font-medium",children:t(`behavior.severity.${s}`)||s})]},s)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:t("behavior.description")||"Description"}),e.jsx("textarea",{value:c.description,onChange:s=>y({...c,description:s.target.value}),rows:3,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.descriptionPlaceholder")||"Describe the behavior..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action Taken",e.jsxs("span",{className:"text-gray-400 text-xs ml-1",children:["(",t("common.optional")||"Optional",")"]})]}),e.jsx("textarea",{value:c.actionTaken||"",onChange:s=>y({...c,actionTaken:s.target.value}),rows:2,className:"w-full border border-gray-300 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:t("behavior.actionTakenPlaceholder")||"Describe any actions taken..."})]}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-3 border-t mt-6",children:[e.jsx("button",{type:"button",onClick:()=>R(!1),className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:t("common.cancel")||"Cancel"}),e.jsx("button",{type:"submit",disabled:f||!c.description.trim(),className:i("px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white","bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","transition-all duration-200",(f||!c.description.trim())&&"opacity-50 cursor-not-allowed"),children:f?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t("common.updating")||"Updating..."]}):t("common.update")||"Update"})]})]})]})}),be&&!a&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-red-600",children:t("behavior.confirmDelete")||"Confirm Delete"}),e.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-gray-700 mb-4",children:t("behavior.deleteWarning")||"Are you sure you want to delete this behavior record? This action cannot be undone."}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsxs("span",{className:"font-medium",children:[t("behavior.date")||"Date",":"]})," ",A(new Date(x.date),"PPP")]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.jsxs("span",{className:"font-medium",children:[t("behavior.description")||"Description",":"]})," ",x.description]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>D(!1),className:"px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:t("common.cancel")||"Cancel"}),e.jsx("button",{onClick:Te,disabled:L,className:i("px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white","bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500","transition-colors",L&&"opacity-50 cursor-not-allowed"),children:L?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t("common.deleting")||"Deleting..."]}):t("common.delete")||"Delete"})]})]})}),ve&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t("behavior.recordDetails")||"Record Details"}),e.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-500 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.date")||"Date",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:A(new Date(x.date),"PPP")})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.student")||"Student",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:((re=q.find(s=>s.id===x.studentId))==null?void 0:re.name)||x.studentId})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.category")||"Category",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:t(`behavior.category.${x.category}`)||x.category})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.severity")||"Severity",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:t(`behavior.severity.${x.severity}`)||x.severity})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.description")||"Description",":"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-line",children:x.description})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.actionTaken")||"Action Taken",":"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-line",children:x.actionTaken||"-"})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[t("behavior.reportedBy")||"Reported By",":"]}),e.jsx("span",{className:"block text-sm text-gray-900",children:((ae=x.reporter)==null?void 0:ae.name)||"System"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>F(!1),className:"w-full px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 transition-colors",children:t("common.close")||"Close"})})]})})]})}export{Qe as default};
