const w=(o,c={})=>new Promise((h,n)=>{const{maxWidth:m=800,maxHeight:g=800,quality:p=.8,format:s="jpeg"}=c,a=new Image,r=document.createElement("canvas"),d=r.getContext("2d");if(!d){n(new Error("Could not get canvas context"));return}a.onload=()=>{let{width:t,height:e}=a;if(t>m||e>g){const l=Math.min(m/t,g/e);t=Math.floor(t*l),e=Math.floor(e*l)}r.width=t,r.height=e,d.drawImage(a,0,0,t,e);const u=s==="png"?"image/png":s==="webp"?"image/webp":"image/jpeg",x=r.toDataURL(u,p);h(x)},a.onerror=()=>{n(new Error("Failed to load image"))};const i=new FileReader;i.onload=t=>{var e;a.src=(e=t.target)==null?void 0:e.result},i.onerror=()=>{n(new Error("Failed to read file"))},i.readAsDataURL(o)}),f=o=>o>1048576?{maxWidth:400,maxHeight:400,quality:.6,format:"jpeg"}:o>524288?{maxWidth:600,maxHeight:600,quality:.7,format:"jpeg"}:{maxWidth:800,maxHeight:800,quality:.8,format:"jpeg"};export{w as compressImageToBase64,f as getOptimalCompressionSettings};
