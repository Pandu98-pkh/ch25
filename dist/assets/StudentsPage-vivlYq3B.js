import{u as C,j as e,c as w}from"./index-CPR8hM9m.js";import{r as n,u as M}from"./react-vendor-aXCYw_-y.js";import{A as k,s as F,t as I,n as E,u as O,v as W,X as _,U as z,w as J,x as P,R as K,y as Q}from"./ui-vendor-DZXJ8q2B.js";import{g as V,c as Y}from"./studentService-D9DYk2TT.js";import{c as Z,a as ee}from"./api-C9ytrIjn.js";const R={good:{color:"text-green-700",bgColor:"bg-green-50",borderColor:"border-green-200",icon:I},warning:{color:"text-yellow-700",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",icon:F},critical:{color:"text-red-700",bgColor:"bg-red-50",borderColor:"border-red-200",icon:k}};function se({student:t,onClick:j}){const l=t.academicStatus||"warning",{t:r}=C(),[g,h]=n.useState(!1),p=t.avatar||t.photo||"/assets/images/default-avatar.png",o=R[l]||R.warning;return e.jsxs("div",{onClick:()=>j(t),className:`bg-white rounded-xl shadow-sm hover:shadow-md transition-all duration-300 
                cursor-pointer overflow-hidden group border border-gray-200 relative transform hover:-translate-y-1`,children:[e.jsx("div",{className:w("h-1.5 w-full absolute top-0 left-0",o.bgColor)}),e.jsxs("div",{className:"p-5 pt-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[g?e.jsx("div",{className:"h-16 w-16 rounded-full bg-gradient-to-br from-indigo-100 to-purple-100 flex items-center justify-center ring-2 ring-gray-100 group-hover:ring-indigo-200 transition-all",children:e.jsx(E,{className:"h-8 w-8 text-indigo-400"})}):e.jsx("img",{src:p,alt:t.name,className:"h-16 w-16 rounded-full object-cover ring-2 ring-gray-100 group-hover:ring-indigo-200 transition-all duration-300",onError:()=>h(!0)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 group-hover:text-indigo-700 transition-colors duration-200 truncate",children:t.name}),e.jsxs("div",{className:w("px-2.5 py-1 rounded-full text-xs font-medium flex items-center",o.bgColor,o.color,`border ${o.borderColor}`),children:[e.jsx(o.icon,{className:"w-3.5 h-3.5 mr-1"}),r(`status.${l}`)]})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center",children:[e.jsx(O,{className:"h-3.5 w-3.5 mr-1.5 text-indigo-400"}),r("students.tingkat")," ",t.tingkat||t.grade," â€¢ ",r("students.kelas")," ",t.kelas||t.class]})]})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 border border-gray-100 transition-all duration-200 group-hover:border-indigo-100",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-1",children:[e.jsx(W,{className:"h-3.5 w-3.5 mr-1.5 text-indigo-400"}),r("studentDetail.academicStatus")]}),e.jsx("p",{className:w("font-semibold text-sm",o.color),children:r(`status.${l}`)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 border border-gray-100 transition-all duration-200 group-hover:border-indigo-100",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-1",children:[e.jsx(E,{className:"h-3.5 w-3.5 mr-1.5 text-indigo-400"}),r("studentDetail.email")]}),e.jsx("p",{className:"font-medium text-sm text-gray-700 truncate",children:t.email||"No email"})]})]}),(t.mentalHealthScore!==void 0||t.lastCounseling)&&e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[t.mentalHealthScore!==void 0&&e.jsxs("div",{className:"p-3 rounded-lg bg-indigo-50 border border-indigo-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-indigo-600 font-medium",children:r("studentDetail.mentalHealthScore")}),e.jsxs("span",{className:"text-sm font-bold text-indigo-700",children:[t.mentalHealthScore,"/100"]})]}),e.jsx("div",{className:"mt-2 h-1.5 w-full bg-indigo-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-indigo-600 rounded-full",style:{width:`${t.mentalHealthScore}%`}})})]}),t.lastCounseling&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2 flex items-center",children:[e.jsx(F,{className:"h-3.5 w-3.5 mr-1.5 text-indigo-400"}),r("studentDetail.lastCounseling"),": ",e.jsx("span",{className:"ml-1 font-medium text-gray-700",children:t.lastCounseling})]})]})]})]})}function ae({onClose:t,onSubmit:j}){const{t:l}=C(),[r,g]=n.useState({name:"",email:"",tingkat:"",kelas:"",avatar:"/assets/avatars/default-avatar.png",academicStatus:"good"}),h=n.useRef(null),N=s=>{s.preventDefault();const d={...r,grade:r.tingkat,class:r.kelas,photo:r.avatar||"/assets/avatars/default-avatar.png"};j(d),t()},p=s=>{var b;const d=(b=s.target.files)==null?void 0:b[0];if(!d)return;if(!d.type.startsWith("image/")){alert(l("addStudent.invalidImageType"));return}if(d.size>2*1024*1024){alert(l("addStudent.imageTooLarge"));return}const v=new FileReader;v.onload=y=>{var c;(c=y.target)!=null&&c.result&&g({...r,avatar:y.target.result})},v.readAsDataURL(d)},o=()=>{var s;(s=h.current)==null||s.click()};return e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:l("addStudent.title")}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:e.jsx(_,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:N,className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:l("addStudent.fullName")}),e.jsx("input",{type:"text",id:"name",required:!0,value:r.name,onChange:s=>g({...r,name:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:l("addStudent.email")}),e.jsx("input",{type:"email",id:"email",required:!0,value:r.email,onChange:s=>g({...r,email:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tingkat",className:"block text-sm font-medium text-gray-700",children:l("students.tingkat")}),e.jsxs("select",{id:"tingkat",required:!0,value:r.tingkat,onChange:s=>g({...r,tingkat:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",children:[e.jsx("option",{value:"",children:l("addStudent.selectTingkat")}),["X","XI","XII"].map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"kelas",className:"block text-sm font-medium text-gray-700",children:l("students.kelas")}),e.jsxs("select",{id:"kelas",required:!0,value:r.kelas,onChange:s=>g({...r,kelas:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",children:[e.jsx("option",{value:"",children:l("addStudent.selectKelas")}),["IPA-1","IPA-2","IPA-3","IPS-1","IPS-2"].map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:l("addStudent.academicStatus")}),e.jsxs("select",{id:"status",required:!0,value:r.academicStatus,onChange:s=>g({...r,academicStatus:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500",children:[e.jsx("option",{value:"good",children:l("status.good")}),e.jsx("option",{value:"warning",children:l("status.warning")}),e.jsx("option",{value:"critical",children:l("status.critical")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Foto Siswa"}),e.jsxs("div",{className:"mt-1 flex flex-col items-center",children:[e.jsx("div",{className:"mb-4 relative w-32 h-32",children:e.jsx("img",{src:r.avatar,alt:"Pratinjau foto siswa",className:"absolute inset-0 w-full h-full object-cover rounded-full border border-gray-300",onError:s=>{const d=s.target;d.src="/assets/avatars/default-avatar.png",d.onerror=null}})}),e.jsx("input",{type:"file",ref:h,accept:"image/*",onChange:p,className:"hidden"}),e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Pilih Foto"}),e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Format: JPG, PNG, atau GIF"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Ukuran maksimum: 2MB"})]})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:l("addStudent.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-brand-600 hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500",children:l("addStudent.submit")})]})]})]})})}function ne(){const[t,j]=n.useState(""),[l,r]=n.useState(!1),[g,h]=n.useState([]),[N,p]=n.useState(!0),[o,s]=n.useState(null),[d,v]=n.useState(1),[b,y]=n.useState(1),[c,D]=n.useState("all"),[T,L]=n.useState(0),B=3,{t:i}=C(),G=M(),S=n.useCallback(async()=>{var m,f;const{clearTimeout:a}=Z(15e3);try{p(!0),s(null);const x={};t&&(x.searchQuery=t),c!=="all"&&(x.academicStatus=c);const u=await V(x,d);a(),u&&u.data?(h(u.data),y(u.totalPages||1)):(s(i("errors.invalidData")||"Data tidak valid"),h([]))}catch(x){if(ee.isAxiosError(x)){const u=x;u.code==="ERR_CANCELED"?s(i("errors.timeout")||"Waktu permintaan habis"):s(((f=(m=u.response)==null?void 0:m.data)==null?void 0:f.detail)||(u.code==="ECONNABORTED"?i("errors.timeout")||"Waktu permintaan habis":i("errors.loadingStudents")||"Gagal memuat data siswa"))}else s(i("errors.loadingStudents")||"Gagal memuat data siswa");h([])}finally{p(!1)}},[d,i,t,c]);n.useEffect(()=>{S()},[S]);const U=async a=>{var m,f;try{s(null);const x=await Y(a);h(u=>[...u,x]),r(!1)}catch(x){s(((f=(m=x.response)==null?void 0:m.data)==null?void 0:f.detail)||i("errors.creatingStudent")||"Gagal membuat data siswa")}},$=a=>{G(`/students/${a.id}`)},q=()=>{T<B?(L(a=>a+1),S()):s(i("errors.maxRetriesReached")||"Batas percobaan telah tercapai")},A=g.filter(a=>{const m=a.name.toLowerCase().includes(t.toLowerCase()),f=c==="all"||a.academicStatus===c;return m&&f}),H=a=>{D(m=>m===a?"all":a)},X=a=>{switch(a){case"good":return e.jsx(I,{className:"h-4 w-4 mr-1"});case"warning":return e.jsx(F,{className:"h-4 w-4 mr-1"});case"critical":return e.jsx(k,{className:"h-4 w-4 mr-1"})}};return e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-600 to-purple-700 w-12 h-12 rounded-lg flex items-center justify-center shadow-lg mr-4",children:e.jsx(z,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600",children:i("students.title")}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:i("students.subtitle")})]})]})}),e.jsx("div",{className:"mb-6 bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:i("students.search"),value:t,onChange:a=>j(a.target.value),className:"pl-10 pr-4 py-2.5 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("div",{className:"bg-gray-100 p-1 rounded-lg flex",children:["good","warning","critical"].map(a=>e.jsxs("button",{onClick:()=>H(a),className:w("px-3 py-1.5 rounded-md text-sm font-medium flex items-center transition-all duration-200",c===a?a==="good"?"bg-green-600 text-white shadow-sm transform scale-105":a==="warning"?"bg-yellow-600 text-white shadow-sm transform scale-105":"bg-red-600 text-white shadow-sm transform scale-105":"bg-transparent text-gray-700 hover:bg-gray-200"),children:[X(a),i(`status.${a}`)]},a))})}),e.jsxs("button",{onClick:()=>r(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 shadow-sm transition-all duration-200 transform hover:scale-105",children:[e.jsx(P,{className:"h-5 w-5 mr-2"}),i("students.add")]})]})]})}),o&&e.jsxs("div",{className:"mb-6 bg-red-50 rounded-xl shadow-sm border border-red-200 overflow-hidden",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-5 w-5 text-red-500 mr-3"}),e.jsx("p",{className:"text-red-700 font-medium",children:o})]}),e.jsxs("button",{onClick:q,className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition-colors duration-200",children:[e.jsx(K,{className:"h-4 w-4 mr-2 animate-spin-slow"}),i("actions.retry")||"Coba lagi"]})]})}),e.jsx("div",{className:"h-1 w-full bg-gradient-to-r from-red-500 to-red-300"})]}),N?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((a,m)=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-5 overflow-hidden",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-1.5 bg-indigo-200 w-full absolute top-0 left-0"}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"rounded-full bg-gray-200 h-16 w-16"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"h-16 bg-gray-200 rounded"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded"})]}),e.jsx("div",{className:"mt-3 h-8 bg-gray-200 rounded"})]})},m))}):e.jsxs(e.Fragment,{children:[A.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"bg-gray-100 w-16 h-16 rounded-full mx-auto flex items-center justify-center mb-4",children:e.jsx(Q,{className:"h-8 w-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-600 font-medium",children:t||c!=="all"?i("students.noResults")||"Tidak ada hasil yang cocok":i("students.noStudents")||"Belum ada data siswa"}),!t&&c==="all"&&e.jsxs("button",{onClick:()=>r(!0),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 shadow-sm transition-all duration-200",children:[e.jsx(P,{className:"h-5 w-5 mr-2"}),i("students.add")||"Tambah Siswa"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(a=>e.jsx(se,{student:a,onClick:$},a.id))}),b>1&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsxs("nav",{className:"inline-flex rounded-lg shadow-sm bg-white border border-gray-200 overflow-hidden divide-x divide-gray-200",children:[e.jsx("button",{onClick:()=>v(a=>Math.max(1,a-1)),disabled:d===1,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors duration-200",children:i("pagination.previous")||"Sebelumnya"}),e.jsxs("div",{className:"px-4 py-2 bg-gray-50 text-sm font-medium text-gray-700",children:[d," / ",b]}),e.jsx("button",{onClick:()=>v(a=>Math.min(b,a+1)),disabled:d===b,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors duration-200",children:i("pagination.next")||"Berikutnya"})]})})]}),l&&e.jsx(ae,{onClose:()=>r(!1),onSubmit:U})]})}export{ne as default};
